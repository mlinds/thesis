
\chapter{Results}


\section{Kriging and Kalman update validation}

First, the basic approach behind both the kriging interpolation method, and the GEBCO measurement update are validated. To test this, instead of using ICESat-2 data as an input to the kriging step, random point samples of the validation data are taken throughout a single area of interest. This provides a source of exact point data with an RMSE of 0m. Two types of random sampling are considered, randomly across the surface of the validation data, and also samples that are taking along the corresponding ICESat-2 tracks. This simulates the presence of a theoretical perfect ICEsat-2 bathymetry data, and can be compared to the random sampling case to investigate the effect of the tracklines. Any available ICEsat-2 bathymetric data will occur along colinear track lines, and therefore there would always be some spatial gaps in the data even if perfect ICESat-2 data were present along every single tract. By comparing the randomly sampled points to colinear points along the ICESat tracks, we can get an estimation of how much the accuracy is degraded by the data being available only along certain lines. 

A small section of the St. Croix test site is used to implement this trial. First, the raster of the validation data is sampled randomly until there are $10,000$ data points. A larger number of point samples than needed is taken, then of these points $2000$ points are subsampled using the Poisson disk sampling method. 

Figure \ref{fig:truthras-sampling} shows both sets of points that were used as input to the kriging process for the two cases under evaluation. Note that in the bottom figure  there are significant spatial gaps in coverage. This is due to the pattern of ICESat-2 data collection. Even in this theoretical scenario with exact bathymetry values available across the entire track, the spatial anisotropy of the availability of the points can potentially limit the accuracy of the interpolation.

\begin{figure}[h]
    \centering
    \includegraphics{figures/truthraster_sampling_combined.pdf}
    \caption{Top: Random sampling across the area of interest \newline   Bottom: Random sampling only along the ICESat-2 tracks for the site}
    \label{fig:truthras-sampling}
\end{figure}

Because we know the bathymetry points used for this section are exactly the same as the validation data at each point, the \emph{nugget} of the variogram for the Kriging interpolation is set to $0$, so areas that are close known points are given a variance of $0$ by the kriging process. 
\pdfcomment{rerun notebook one more time3}
\input{tables/truth_raster_sample_error.tex}

Table \ref{tab:random-vs-colinear-sampling} shows the results of the two sampling strategies. It can be seen that the more homogenous distribution of bathymetric points in the randomly-sampled data produces a better kriging estimate (RMSE of 3.13m and 4.49m respectively). 

Also of note is that for both cases, the Bayesian combination of the kriging surface with GEBCO produces a better estimate than either on their own. This indicates that there is value in starting from GEBCO and using a bayesian combination approach when compared to either a kriging interpolation of point data or using GEBCO as a data source.


\section{Petten Test Site}
Most research results show that spaceborne lidar is not effective at retrieving bathymetry from very turbid waters. To test the upper limits of this, ICESat-2 data for the coast of Petten, NL was downloaded. As expected, there was no bathymetric signal was found in the ICESat-2 data, likely due to the inability of the laser to penetrate the turbid water. 

However the site provides a useful case to validate the approach of the combination of universal kriging of point bathymetry and Bayesian combination of bathymetry grids. The Dutch government provides a dataset called Jarkus which consists of annual manually surveyed elevations of the coastal zone. These point measurements provide an interesting case to apply the same method but using the Jarkus point measurements as an input instead of ICESat-2 point measurements.

The location of Petten, The Netherlands, located on the Noord-Holland coast, was chosen based on the availability of high-resolution ground-truth bathymetry provided by Van Oord. The survey was performed in 2021, and therefore the 2021 Jarkus points were selected from the dataset. All Jarkus points that overlap the validation data raster were selected. Like the ICESat-2 data points, the Jarkus points are available only along colinear lines. This is due to the measurement method that is based on surveying the dune and seabed starting from a series of fixed measurement poles and then surveying points normal to the shore starting at the reference pole. 


\begin{figure}[h]
    % \centering   
    \includegraphics[]{figures/Petten_photon_map.pdf}
    \caption{Jarkus 2021 measurement points within the site}\pdfcomment{figure out how to rotate}
    \label{fig:jarkus-points}
\end{figure}

The Jarkus point measurements were checked for the same error metrics as the ICESat-2 points. The bias plot is shown in Figure \ref{fig:petten-bias-plot}. It is notable that the deviation between the Jarkus data and the survey data is greatest in the in the shallowest part of the nearshore zone; this is likely due to some morphological changes due to wave-drived sediment exchange between the nearshore and the offshore. Both datasets are from 2021, but this area is highly morphologically active. Also, in the deeper part of the study area, the error  between the two datasets decreases significantly. This is likely due to the depth of closure for most profiles in the study area being located between -5 and -10m. 

\begin{figure}[h]
    \centering
    \includegraphics{figures/petten_lidar_estimated_vs_truth.pdf}
    \caption{Petten Test site: Agreement between Jarkus and Van Oord multibeam survey data}
    \label{fig:petten-bias-plot}
\end{figure}

The universal kriging and Kalman Updating concepts are tested for this site. The Jarkus points are used as input to the kriging process instead of ICESat-2 points. It is notable that in this site, the error between GEBCO and the high resolution bathymetry is significantly lower than other test sites. This could be due to higher quality or more recent input data into the GEBCO grid as compared to the other sites. Even with a higher accuracy in the GEBCO data, the kriged bathymetry surface was found to have a lower RMSE and MAE error than GEBCO. However, it was found that the bayesian combination of both of these datasets has the highest accuracy --- indicating that the Bayesian combination of these two datasets provides increases the value compared to either data set individually. 

\input{tables/petten_kalman_improvement.tex}


\section{Florida Keys test site}

\pdfcomment{talk about the validation data for the site}

The area surrounding Marathon Key in the Florida Keys archipelago in Florida, USA was used as one site to test the entire process, including the ICESat-2 signal finding in additional to the kriging and Kalman updating. The area has a wide and relatively shallow ($\mathcal{O}(-10 m +MSL)$) shelf, a microtidal tidal environment, and very clear water, so it is an ideal site for remote sensing of bathymetry. The clear and shallow water provides a relatively strong subsurface signal within ICESat-2 transects. The site was found to have many transects of ICESat-2 data with distinct bathymetric signal. The KDE signal finding approach was applied to all transects within the study area and resulting distribution of the identified signal points is shown in figure \ref{fig:keys-photons}.

\begin{figure}[h]
    \centering
    \includegraphics{figures/florida_keys_photon_map.pdf}
    \caption{Marathon Key Site: Location and depth of bathymetric signal points found using KDE signal finding method}
    \label{fig:keys-photons}
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics{figures/florida_keys_lidar_estimated_vs_truth.pdf}
    \caption{Marathon Key site: Bias plot showing the results of the KDE signal finding algorithm}
    \label{fig:keys-biasplot}
\end{figure}

Figure \ref{fig:keys-biasplot} shows how the error is distributed within the Florida Keys test site. This site has many transects containing data, but some errors in the signal finding can be seen in this bias plot. There is one cluster of points with a real elevation of -2.5m, while the KDE finding output identifies the seafloor elevation as between -20 and -27m.  The figure also shows a few clusters of points where the seabed location was overestimated slightly. 

However, the kriging process can account for an expected degree of error, and can be set up such the input points are not considered exact measurements but are considered to have their own uncertainty at each point. This is controlled by the \emph{nugget} variogram parameter. 


The Kriging and Kalman updating steps were applied and the results are shown in table \ref{tab:florida_keys_gebco_raster_error}.

\input{tables/florida_keys_kalman_improvement.tex}


\section{St. Croix test site}

Another site where the entire processing chain was implemented was in the Caribbean island of St. Croix. The site was chosen based on the availability of recent high-resolution bathymetry validation data, and also on the basis of the clear water. The site provides some interesting constrasts: The south edge of the island is a relatively gently sloping shelf, while the north edge of the island has an extremely steep shoreline. On the northeast edge there is a bank between the main island and a smaller island.

The validation data is provided by a USGS-sponsored survey of the area using a Riegl VQ-880-G II lidar sensor between January and June 2019. The lidar point data was then post-processed into a 1m raster DEM product with a bathymetric vertical accuracy of $12.1 cm$ when compared to the survey control points \parencite{}. This DEM was utilized for this research.


\begin{figure}[htbp]
    \centering
    \includegraphics{figures/stcroix_photon_map.pdf}
    \caption{St. Croix site: Identified photons and their depth}
    \label{fig:st-croix-photons}
\end{figure}

The bathymetric point measurements obtained from the KDE signal finding algorithm are shown in \ref{fig:st-croix-photons}. This site showed excellent agreement between the ICESat-2 data and the validation data, and the KDE signal finding algorithm reliably identified bathymetric points as deep as -20m +MSL. The overall RMSE at the site was the lowest of any sites tested, at 0.54m. Figure \ref{fig:st-croix-bias-plot} shows the spread of the ICESat-2 points vs the corresponding point in the validation data.

\begin{figure}[htbp]
    \centering
    \includegraphics{figures/stcroix_lidar_estimated_vs_truth.pdf}
    \caption{St. Croix site: Identified photons and their depth}
    \label{fig:st-croix-bias-plot}
\end{figure}

After implementing the Kriging/Kalman updating process for the St. Croix site we find that the combination of the kriged ICESat-2 raster with the GEBCO data produces a resulting product that has a higher accuracy than either of the input datasets. Particularly of note here is the inaccuracy of the GEBCO data at this site --- while the overall RMSE of the resulting raster is high at this site compared to some others, in this case it is limited by the accuracy of the starting GEBCO data, and the accuracy of the kriging raster. Table \ref{tab:stcroix_gebco_raster_error} shows the improvement achieved through the Kalman Update process.

\input{tables/Stcroix_kalman_improvement.tex}

\section{Charlotte Amalie test site}

\section{Oahu Test sites}\label{sec:oahuresults}

For another validation site that is outside of the Caribbean sea, the island of Oahu in the US state of Hawai'i was chosen. The validation data used is a lidar survey completed in 2013. The nearshore zone was surveyed by the United States Army Corps of Engineers (USACE) using the Coastal Zone Mapping and Imaging Lidar (CZMIL). The survey data was collected by aircraft from September to November 2013. The raw lidar point cloud data was then further processed into a 1m DEM via TIN interpolation. The resulting 1m DEM is referenced to a horizontal datum of NAD83(PA11), and the vertical reference system is the local mean sea level. The data has a vertical accuracy at the 95\% confidence interval of $\sqrt{0.20^2 + (0.013d)^2}$~m, where $d$ is the depth in meters. This translates to a 95\% confidence vertical accuracy of $\pm 28$ cm at a depth of 15~m.

Because this site is substantially larger ($\approx 4x$ the area) than the other test sites, to analyze the data, the coast of the island is first divided into 8 smaller subsites. The layout of these sites was chosen based on approximately similar coastline characteristics. Figure \ref{fig:oahu-subsite-layout} shows the selected layout of the subsites along the coast of Oahu.

\begin{figure}[htbp]
    \centering
    \includegraphics{figures/Oahu_all_tracklines.pdf}
    \caption[Oahu test site: Transects and subsite layout]{Oahu test site: The availability of ICESat-2 transects within the selected subsites. Base layer data provided by: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community}
    \label{fig:oahu-subsite-layout}
\end{figure}

The different subsites also exhibit different hydraulic characteristics. The Northern edge of the island is exposed to longer swells and larger wave heights, while the south is relatively sheltered \parencite{Vitousek2008a}. Another aspect is that distribution of ICESat-2 tracks is not even across all sites. Sites 4 and 6, for example do not contain any ascending \pdfcomment{check ascending/descending} transects with good data, so distribution of the data will be more uneven and might reduce the quality of the kriging raster.

The accuracy of the ICESat-2 data points from the KDE signal finding algorithm, grouped by subsite, are shown in Table \ref{tab:Oahusitestats}. It can be seen that site 2 has an anomalously high RMS error. 

\begin{figure}[htbp]
    \centering
    \includegraphics{figures/Oahu_all_sites_photon_points.pdf}
    \caption{Bathymetry point estimates around Oahu from KDE signal finding algorithm}
    \label{fig:oahu-photon-map}
\end{figure}


\begin{figure}
    \begin{floatrow}
    \capbtabbox{\input{tables/oahu_percent_change.tex}}{\caption{Percent reduction in error metrics via the Kalman updating approach. Positive values indicate reduced error, negative ones indicate increased error}\label{tab:oahu-percent-change}
    }
    \capbtabbox{%
    \input{tables/Oahu_all_sites_RMSE_summary.tex}
    }{\caption{Error metrics between ICESat-2 and ground-truth data for all sites in Oahu}
    }
    \end{floatrow}
\end{figure}


The cause of this is a weakness in the subsurface filtering process \pdfcomment{add figure}. In there case, there is steep seaside cliff that is not captured by the low-resolution of the GEBCO grid. As this area of the transect occurs on land, it ideally should have been removed during the horizontal filtering step. Due to this issue, points are inadvertently included in the subsurface photon dataset for the transect, and the KDE signal finding algorithm incorrectly identifies these points as signal. Because the actual elevation of the validation data is about 80-140~m in this area, and the output of the KDE signal finding is approximately -5~m in this area. Because of this, the RMSE metric for each of these points is anomalously high. With this in mind, these points have been removed from some subsequent analyses of the data to better show the distribution of errors in other points. Figures \ref{fig:oahu-bias-mountains} and \ref{fig:oahu-bias-nomounts} are combined bias plots that show the ICESat-2 bathymetry points of all subsites. The incorrectly classified mountain points can be seen on the right edge of Figure \ref{fig:oahu-bias-mountains}. Figure \ref{fig:oahu-bias-nomounts} is a plot of the error excluding these mountain points. 

The Kalman update step was also applied individually to each subsite. The Kalman updating step for the various Oahu subsites shows a more mixed result than in other test sites. A summary of the changes in the error metrics for each subsite is provided in Table \ref{tab:oahu-percent-change}. In some sites, the Kalman update does not improve the estimate, and in some cases has an even higher error the a-priori GEBCO estimate. This is an indication that the parameters are not set correctly for the site --- using bayesian estimation, the parameters should be able to be set such that areas within the grid that have lower confidence are not changed significantly. 

The integration of the ICESat-2 to GEBCO via Kalman updating does not improve the bathymetry estimates in subsites 6-8. For site 6, this is likely due to the quality of the ICEsat-2 data --- it has a very high RMSE and almost no bathymetry points in this subsite that were identified by the KDE signal-finding algorithm. There are several possible reasons for this. For one, the site has fewer transects available from the NSIDC portal, so there is less data to start with. Additionally, subsite 6 is located along the north edge of the island which experiences higher wave energy conditions than other subsites \parencite{Vitousek2008a}. The higher energy wave environment could degrade the quality ICESat-2 bathymetry data in two ways: increasing the slope of the local sea surface and therefore increasing the refraction error, and the whitecapping at the site could affect the ability of laser photons to penetrate to the seabed. The whitecapping effect can be seen in satellite imagery of the subsite in Figure \refname{fig:site-6-photons}.

However, the effect cannot be fully explained by the quality and quantity of ICESat-2 bathymetry points. Sites 7 and 8 both have significant amounts of ICESat-2 bathmetry points available with relatively low RMSE values ($1.11 m$ and $0.67 m$ respectively). Understanding why the Kalman updating approach did not improve the results requires examining the resulting bathymetric surfaces. On the west side of Oahu, the validation dataset includes bathymetry as deep as -60 m in some areas. However, the deepest ICESat-2 photons in the subsite are only at a depth of -13 m. Because the deepest depths that are input to the kriging algorithm are -13 m, the deepest parts of the interpolated bathymetric surface are approximately the same depth. Based on the chosen range parameter of $10,000 m$



\begin{figure}
    \begin{floatrow}
        \ffigbox{\includegraphics{figures/Oahu_combined_lidar_estimated_vs_truth.pdf}}{\caption{Bias plot of all points within all Oahu Subsites}\label{fig:oahu-bias-mountains}}
        \ffigbox{\includegraphics{figures/Oahu_combined_mountains_removed_lidar_estimated_vs_truth.pdf}}{\caption{Bias plot with the mountain points removed to better show the actual distribution of the error}\label{fig:oahu-bias-nomounts}}
    \end{floatrow}
\end{figure}



\section{Prediction of Lidar error}

One of the challenges of extracting bathymetry from ICEsat-2 data is finding robust, automated ways of distinguishing between signal and noise. For the KDE approach utilized here, a minimum kernel density of $max(kde_{50},0.10)$ was found to give good results with rejecting most of the most severe errors. Increasing the minimum parameter to 0.15 decreased the RMSE, but at the expense of throwing out significant amount of high quality data at the same time. 

Therefore, better methods are required to predict the quality of the bathymetry data in places without in-situ data. Three possible ways to approaching this are explored: analyzing which parameters predict the error at the level of an individual photon, and also averaging by transect and by site.

\subsection{Per-photon error}
Several variables that are provided on a per-photon basis which might have some impact on the error at each photon. Two variables that were checked for their relationship to the error of a single photon are the count of photons in the 20 m segment (\emph{count\_ph} in the ATL03 data). This is the count of photons that are in within the 20 m segment around the reference photon. An indication of the total count of photons could be useful to predict the presence of bathymetric signal, since fewer segments being present in a segment might indicate data issues (e.g., interference from clouds) in the surrounding area. 

To evaluate the effect, every single bathymetry point from all sites were combined. The comparison between the absolute error and the count of photons in the local 20 m segment is shown in Figure \ref{fig:photon-cnt-v-abs-error}. The cluster of photons with an absolute error in the range 80-150 m are those identified in Oahu site 2. Because the reason for the anomalously high error for these is known, they will not examined any further here (see section \ref{sex:oahu etc} ).

Looking at the other photons, clustered near the bottom of Figure \ref{fig:photon-cnt-v-abs-error}, there is indeed a relationship between the photon count variable and the absolute error --- the photons with higher absolute error (from 20-40 m) are all clustered near the left side of the graph, indicating that many of the photons with a large error occur in transects with a photon count from 0-200. However, there is a large density of photons with a relatively low error value that are also in this range. Therefore, it presents the same tradeoff as increasing the kernel density threshold - increasing it will increase the quality of the data, but also requires throwing out a very significant amount of good data at the same time. 

\begin{figure}[htbp]
    \centering
    \includegraphics{figures/error_by_ph_count.pdf}
    \caption{Relationship between Photon Count and absolute error}
    \label{fig:photon-cnt-v-abs-error}
\end{figure}

Another variable that was checked at the photon level is the percent of pulses within the segment that are determined to be fully satured. This can also be an indication of data issues in the segment. However this variable is also not a good predictor of error in an individual photon, as seen in Figure \ref{fig:full-sat-frac-v-abs-error}. Part of the reason for this is that nearly all of the segments included here have a full saturation fraction of 0.0 (99.1\% of photons in all study sites). 

\begin{figure}[htbp]
    \centering
    \includegraphics{figures/error_by_full_sat.pdf}
    \caption{Relationship between the fraction of fully saturated photons and absolute error}
    \label{fig:full-sat-frac-v-abs-error}
\end{figure}

\subsection{Per-transect error}

Another useful metric is understanding which transect-level variables could indicate good bathymetry data within a transect. This could potentially allow pre-selection of some transects over others before running the KDE algorithm, allowing reduction of required computing cycles.

To calculate the transect-level statistics, the aggregate RMS error was calculated by grouping the dataset of all bathymetry points by the date, beam type, and site. 

One variable that was checked at the transect level is the Secchi Disk Depth. The median Secchi disk depth was calculated for each unique transect, and then compared to the aggregate RMSE for that transect. Figure \ref{fig:transect-rmse-zsd} shows the resulting plot. For this purpose, the large magnitude errors from Oahu subsite 2 were removed, since they are caused by a known issue that is not related to the Secchi disk depth.

\begin{figure}[htbp]
    \centering
    \includegraphics{figures/track_secchi_vs_rmse.pdf}
    \caption{Relationship between median Secchi Disk depth and RMS error of ICESat-2 data, per transect}
    \label{fig:transect-rmse-zsd}
\end{figure}

This establishes that there is no clear relationship between the median Secchi disk depth of a trackline and the RMS error of the ICESat-2 bathymetry data contained in that trackline.

One transect level variable that was checked is the percentage of ocean surface photons classified as high-confidence signal. This parameter is extracted from the \emph{qa\_perc\_signal\_conf\_ph\_high} within the \emph{/quality\_assesment/} group within the ATL03 data.

Often, bathymetry signal points are not classified as high confidence ocean-surface photons in the official ATL03 classification. However, there could be an indirect relationship between the percentage of high confidence ocean photons and the bathymetry signal quality, because the percentage of high confidence ocean photons could be a proxy for the transect data quality in general (i.e., good atmospheric/weather conditions, no instrument issues, etc).


\begin{figure}[htbp]
    \centering
    \includegraphics{figures/track_hconf_oc_vs_rmse.pdf}
    \caption{Relationship to percentage of high quality photons in a transect to the RMS error in the transect}
    \label{fig:transect-phconf-rmse}
\end{figure}

Figure \ref{fig:transect-phconf-rmse} shows the relationship between the percentage of high confidence ocean signal photons and the RMS error. On the right side of the graph, it can be seen there are a large number of transects with a more than 95\% high confidence signal but still showing significant RMS error. Therefore, this variable does not provide a good way to determine which transects contain quality signal --- any filtering based on the percent of high confidence ocean signal photons would remove some useful data, while leaving many of the lower quality transects. 

Previous research on ICESat-2 bathymetry has found that the beam strength can have some effect on the quality of the bathymetry data obtained. To investigate this relationship, the transects were grouped by this binary variable to find the RMS of all strong beams and all weak beams. For this approach, it was found that the strong beams did have a slightly higher RMS error, but also were able to extract many more photons. Table \ref{tab:error-by-strongweak} shows the error metrics, and the total count of points found for each type of transect. 

\input{tables/rmse_by_strongweak.tex}

\subsection{Per-site error}

