\chapter{Introduction}

\todo{Check that all citations resolve properly}
\todo{redo diagrams}

\section{Motivation and Relevance}

Coastal areas are attractive for human settlement, and up to 39\% of human population lives within 100km of the coast \parencite{Magdalena2021}, including many of the world's largest cities. 10\% of the world's population live in the an area that is less than 10m above sea level \parencite{Neumann2015,Lichter2011}, an area known as the Low Elevation Coastal Zone. All coastal populations face increasing vulnerability to coastal flooding hazards, due to increases in the sea level and changes in extreme weather patterns. To protect populations from these increasing risks, further investment in coastal protection is required; without more investment in coastal defense infrastructure, the population exposed to flooding risk is projected to increase by 50\% \Parencite{Kirezci2020}. One approach to mitigating these hazards is to employ the techniques of Building with Nature, using natural processes and ecosystem functions to create resilient coastal defenses. \todo{clean up transition}

Mangroves provide coastal protection by reducing wave energy, while also adapting naturally to sea level rise, and providing other ecosystem services like increasing water quality and increasing fish spawning areas. Mangroves already provide flood protection to over 15 million people \parencite{Menendez2020}, but in the last 50 years between 30-50 percent of the world's mangrove area has been lost \parencite{Goldberg2020}.

One current weakness of mangroves as a flood defense strategy is that the response of these natural ecosystems is not well known. The persistance of mangroves over the long term is not as well understood as for traditional hard infrastructure. Traditional hard coastal infrastructure like dams, dikes and seawalls have many years of research on their mechanical responses. To increase the use of BwN solutions, we need increased understanding of the risks and benefits of relying on mangroves for flood defense.

\subsection{Limitations of conventional nearshore survey}

The nearshore zone is a very difficult environment to perform bathymetric surveying. \parencite{Parrish2019}. All current bathymetric survey techniques face limitations that restrict their use in the shallowest 5-10m of the nearshore zone. Most deep water survey is done using multi-beam echo sounders (MBES) attached to ships. This limits their operation in water shallower than 4-5 meters or in areas with navigational hazards \parencite{Cesbron2021,Monteys2015}. The current standard for high resolution survey in the nearshore zone is airborne lidar surveying. However, these surveys are extremely expensive to perform and require extensive post-processing effort to create a usable surface model.


\subsection{Importance of Nearshore Bathymetric Data}

Nearshore bathymetry is crucial data for many aspects of coastal management and research. Bathymetric data is essential for many aspects of the blue economy, including aquaculture, marine energy, submarine cables, dredging operations, design of sea defenses, navigation, scientific research, and ecosystem preservation \parencite{Cesbron2021,Ashphaq2021}. However, the nearshore zone is notoriously difficult to survey. There is currently a global lack of data in the 5-10m zone \parencite{Albright2021} and up to 50\% of the world's shallow coastal zones remain unsurveyed \parencite{IHO/OHI2022}. Where surveys do exist, they can be decades out of date, especially in the 40\% of the world's coasts that are sandy and highly dynamic \parencite{Almar2021e}.

There have been attempts at global bathymetric datasets, most notably GEBCO, which is an annually updated global bathymetric and topograhpic dataset. The bathymetry in GEBCO grids is derived by assimilation of acoustic soundings provided by ships and gravimetric bathymetry measurements \parencite{Cesbron2021}. While it provides very useful information about deep oceans, the resolution is not sufficient for wave transformation modeling, and because sonar data is limited in many shallow nearshore zones, GEBCO accuracy in the nearshore zone is limited \parencite{Monteys2015}.

In the context of researching the impact of mangroves on flood risk, one of the most important aspects of a wave model is the nearshore bathymetry, since the exact shape and depth of the profile has a large impact on the hydrodynamic response of mangrove ecosystems \parencite{Horstman2014,Maza2019}. The current state of wave modeling of mangrove ecosystems either relies on in-situ survey data, or uses an idealized profile shape. The further development of mangrove wave modeling will benefit from better quantification of bathymetry, topography, and mangrove structure \parencite{Menendez2020}. This detailed data is especially helpful given the heterogeneity between different mangrove forests \parencite{Mazda2013}.


\section{Identified Knowledge gaps}
A major restriction in modeling how mangroves and waves interact is the lack of global nearshore bathymetry data.
\section{Research Question}
The primary question that this project intends to answer is: \\

% \vspace{2mm}
\emph{How can spaceborne remote sensing data be used to improve estimates of nearshore bathymetry along mangrove-lined coasts?}

% \vspace{1cm}
To answer this question, the following subquestions will be investigated:

\begin{itemize}
      \item In which mangrove forests might spaceborne lidar and optical SDB be an effective survey method?
      \item How can spaceborne lidar transects that contain bathymetry be identified algorithmically?
      \item Once transects with bathymetry are found, how can the seafloor elevation data be extracted?
      \item How can lidar photon return locations reflecting the seafloor be separated from background noise?
      \item How can gaps be filled in areas with missing lidar photons?
      \item Which of the established optical SDB methods are most reliable in mangrove ecosystems?
\end{itemize}

\chapter{Proposed Methodology}


\todo{Mention each subquestion}
The following method is proposed to evaluate the effectiveness of combining optical SDB methods with lidar data along mangrove coasts.

\section{Find areas for global analysis}
There are several datasets of the global distribution of mangrove forests. \citeauthor{Giri2011b} derived the first globally consistent remote-sensing-based global extent analysis \parencite{Worthington2020}. Using one of the global extent datasets, \citeauthor{Worthington2020a} created a globally consistent dataset of mangrove typology. Each mangrove area is classified as either carbonate or terrigenous, and is assigned a coast type (Delta, Estuary, Lagoon, Open Coast). This data can provide valuable information on which types of mangrove environments might be favorable to automated bathymetry extraction. Certain mangrove environments might have higher average turbidity and therefore will be harder to get any spaceborn data from. To check the effect of turbidity on the results, the local turbidity at the time of the satellite pass can be found using the GlobColour dataset of ocean color \parencite{Garnesson2019}.

To create areas of analysis for this project, first the \citeauthor{Giri2011b} mangrove extent data will be buffered by a distance large enough so that it includes the offshore area, and these polygons will be generalized to snap to a rectangular grid. Polygons with an area under a certain threshold will be dropped from the dataset. The remaining polygons will be used as locations for the global analysis.

As part of this step, a series of test sites with surveyed in-situ bathymetry will be found, for testing the performance of the satellite derived data.

\section{Download lidar data within areas of interest}
Using a Python script that interacts with the NASA National Snow and Ice Data Center (NSIDC) data download API, the ATL03 variables of interest can be downloaded for each polygon.

\section{Find bathymetric photons}
The data from the satellite consists of raw photon locations along a given track. To find which, if any, photons are reflected from the sea floor, they have to be classified as either bathymetric signal or noise.
Many most previous papers use a variation of the \emph{Density-based spatial clustering of applications with noise (DBSCAN)} algorithm, from \citeauthor{Ester1996} for this purpose.

For this project it is proposed to use the DBSCAN method iteratively with adaptive parameters, to identify bathymetric points. The exact details of the implementation will be tested against the test sites to see which produce the best results.

Some sites, either due to turbidity, depth, or instrument data quality issues, will not provide reliable bathymetry lidar photons. Any sites without lidar reference data will be removed from the analysis.

\section{Correction for refraction and tides}
To correct for the effects of refraction and the tidal elevation, first the tide level at the time and location of the ICESat-2 pass will be found from the archives of the GTSM.  Using this tidal data the ellipsoid height will be into a depth value. Then using the Parrish method the vertical and horizontal error induced by refraction will be found and corrected.

\section{Perform Sentinel-2 SDB Extraction on sites with ICESat-2 Bathymetric data}
Now, a data set of study sites that have some bathymetric lidar returns is established. To estimate the bathymetry, first we need satellite scenes that are approximately contemporaneous with the lidar data. These can be found using Google Earth Engine, a cloud platform that provides access to computational resources and a large catalog of remote sensing data \parencite{Gorelick2017a}. Because of the computational simplicity, a version of the empirical Lysenga\todo{fix algo name} \parencite{add} is proposed to find the find the bathymetry. Because of the high

\section{Summarize and analyze results}


\section{Advantages and limitations}
The proposed method could allow a significant increase in the global data available about mangrove ecosystems, and the analysis could potentially be repeated in the future and more data is available to give a temporal dimension, allowing for assessment of offshore erosion or deposition processes around mangroves. The largest limitation forseen is the turbidity limiting the optical clarity of the water. This might make it difficult to find meaningful data along muddy coasts, and only allow bathymetric analysis of carbonate mangroves which tend to occur in clearer waters.

\section{Proposed method flowchart}
\todo{Update figure based on rewritten methodology}
\begin{figure}
      \centering
      \includegraphics[width=\textwidth]{./figures/approach.png}
      \caption{Proposed Method}
      \label{method-flowchart}
\end{figure}

\chapter{Literature Review}

\section{Lidar Bathymetric surveying}


The earliest attempts to use Light Detecting and Ranging (lidar) to survey the coastal zone date back to the late 1960s. \parencite{Bailly2016}. The technology has matured significantly since then and currently airborne lidar using a strong 532nm laser beam is a common technique for high accuracy bathymetric and topographic surveying. The downside of this technique is that it does not scale well to large areas, because of the expensive equipment, and extensive post-processing work to correct for refraction of the laser beam in the water column, calibration to in situ data, and outlier detection.

Recent advances in lidar technology have allowed the development of the photon-counting lidar, which requires significantly less energy to detect a return signal. These have allowed the practical application of constant lidar data collection in satellites. The use of spaceborne lidar is a more recent area of research, but some early results have shown that spaceborne lidar can find depths as deep as 40m \parencite{Parrish2019}.

The potential for bathymetric mapping using spaceborne laser observations has been noted since before the advent of the ICESat-2 mission. The predecessor mission carried a lidar instrument called the Geoscience Laser Altimeter System (GLAS). GLAS was a green-light laser intended for measuring atmospheric aerosols \parencite{Abshire2005}. However, because of the laser architecture, GLAS was not able to penetrate the water column \parencite{Forfinski-Sarkozi2016}. However, a prototype of ATLAS, called the Multiple Altimeter Beam Experimental lidar (MABEL) instrument was tested with high-altitude aircraft missions, allowing a simulation of the data that would be provided by ATLAS \parencite{Mcgill2013}. Early experiments with MABEL showed good agreement between bathymetric measurements from MABEL and high-quality airborne reference data \parencite{Jasinski2016,Forfinski-Sarkozi2016}.

\section{Mangroves as Coastal Defense}

Sea level rise poses a threat to all coastal communities, including many of the world's largest population centers. The risk is even more existential for low-lying tropical communities, who have done little to contribute to the current climate crisis, but are disproportionately affected by the sea level rise. Low-lying nations often do not have any available high ground to move cities to, and sometimes do not have access to the resources to fully mitigate these risks through hard infrastructure. For these reasons, mangroves forests are an important resource for these communities, providing coastal protection that can adapt to sea level rise by trapping sediment and expanding outward if conditions permit.

One way to adapt to the changing sea levels, and possible increases in extreme weather events is to promote the restoration and expansion of mangrove forests. It is well-established that mangrove forests can reduce wave energy \parencite{Maza2019,Menendez2020,Hadi2003}, and to a more limited extent, storm surges \parencite{Montgomery2019a,Chen2021,Mcivor2012}. Mangroves also offer many other ecosystem benefits including enhancing fish stocks, improving water quality, storing significant amounts of carbon, and attracting tourism \parencite{Atkinson2016b}

\begin{figure}[htbp]
      \centering
      \includegraphics[width = 0.7\textwidth]{figures/mangroves_reefs_Losada2018.png}
      \caption{The protective effects of Mangroves. From \parencite{Losada2018}}
      \label{mangrove-protection-diagram}
\end{figure}


Shallow water bathymetry and mangrove height are difficult to survey manually, due to the difficulty of field work in dense mangrove environments \parencite{Gijsman2021}. Current study of the effects of mangroves on wave attenuation are limited by this lack of hydrodynamic data about these ecosystems \parencite{Horstman2014}.  Therefore, finding an automated way of calculating bathymetry anywhere in the world from publicly available data is a improvement when modeling sites that do not have existing survey data, and can be used to as the basis for wave modeling, and process-based models. Improved models can allow better characterization of the morphologic response to mechanical factors like sea level rise and sediment supply that need further study to understand the system response to climate change.

One weakness of mangroves as a flood protection mechanism is that their response to long term changes in the biogeomorphic environment is not well understood \parencite{Gijsman2021}. This lack of data about the long term persistance of mangrove structures is an impediment to widespread adoption of mangrove as a coastal protection strategy.

\section{ICESat-2}

The ICESat-2 mission is intended to gather high resolution topographic data on a global scale. The satellite carries the Advanced Topographic Laser Altimeter System (ATLAS). ATLAS is a highly sensitive photon-counting, green-light lidar. The satellite instrument points at reference ground tracks (RGT) along the earth's surface, and returns with a repeat time of 91 days. Along the reference track, there are 3 beams, one pointing directly at the reference track, and two that are offset by approximately 3km on either side. The layout of the beams relative to the RGT are shown in figure \ref{fig:icesat-rgts}.

\begin{figure}
      \centering
      \includegraphics[width=0.5\textwidth]{./figures/ATLAS_beam_layout_from_user_guide.png}
      \caption{Layout of the ICESat-2 beams}
      \label{fig:icesat-rgts}
\end{figure}

Each of the 3 beams emits both a strong and weak beam, with the strong beam being approximately 4x more powerful \parencite{Neumann2019d}. Of the approximately \(10^{14}\) of photons emitted per pulse, up to  10 make it back to the sensor and are detected \parencite{Neumann2019d}. The exact number of emitted photons that are subsequently detected at the sensor depends on the local atmospheric conditions and the reflectivity of the surface \parencite{Neumann2019e}. The highly sensitive instrument also receives significant noise, due to scattering and signal from the sun.


\begin{figure}[htbp]
      \centering
      \includegraphics{./figures/3d_beam_view_from_atl03ATBD.png}
      \caption{The layout of the ICESat-2 beams in 3D space. from \cite{Neumann2019d}}
      \label{3d-beams}
\end{figure}


The main mission of the satellite is to gather data about mass and elevation changes in ice sheets and glaciers, and to study global global canopy height \parencite{Markus2017}. To increase the spatial coverage of the vegetation height, the observatory is sometimes pointed away from the reference ground track when flying over land to increase the spatial density of the observations of vegetation height \parencite{Markus2017}. This offpointing begins before the satellite begins to record data over land, so the nearshore coastal area is also included, and therefore bathymetric and hydrological applications also benefit from increased spatial coverage \parencite{Magruder2021}.

To locate the position of each photon in 3D space, the time of flight of the photon is calculated with a precision of 800 ps\parencite{Neumann2019d}. The location of the center of mass of the instrument is found using Global Positioning System (GPS) systems onboard the satellite. By combining the measured time of flight and satellite position, the geolocation of each returning photon is calculated. \parencite{Neumann2019d}.


\subsection{Weak vs. Strong Beams}

The beams are divided into weak and strong signals to enhance the radiometric dynamic range. The strong beams are expected to provide better signal-noise ratios over low-reflectivity surfaces, like the ocean and seafloor \parencite{Neumann2019d}. Therefore, these beams are expected to provide the best data for lidar bathymetry measurements. The weak beams are better for capturing very high reflectivity surfaces like ice, which might otherwise saturate the sensor and not provide useful data.

\subsection{Refraction Correction}

The locations calculated by the data products from the satellite do not correct of the refraction induced by the different speeds and which light travels in water and in the atmosphere. This effect introduces both a horizontal and vertical error in the photon location, as shown in figure \ref{refract-image}.

\begin{figure}[ht]
      \centering
      \includegraphics[width = 0.5\textwidth]{figures/refraction_error.png}
      \caption{The errors caused by the refraction at the air-water interface}
      \label{refract-image}
\end{figure}

When the instrument is pointed directly at the RGT, the laser beams point nearly directly at the satellite's nadir. When directly on-nadir, the additional horizontal error induced by refraction is approximately 9cm \parencite{Parrish2019}, which for bathymetric purposes is negligible. However, by design ATLAS can point up to $5 \degree$ off-nadir (Equal to 43km away from the RGT) \parencite{Magruder2021}. When pointing off-nadir, the horizontal error is much more significant and must be corrected for accurate measurements \parencite{Parrish2019}. In all of these calculations, the water surface is assumed to be flat.


\subsection{Vertical Height Reference}
The ATL03 data product reports the photon heights relative to the WGS84 reference ellipsoid. These ellipsoidal heights already include corrections for the solid earth tides, ocean loading, ocean pole tides, and atmospheric delays.

The height provided in ATL03 is calculated by the following equation:

\[H_{GC} =  H_{P} - H_{OPT} - H_{OL} - H_{SEPT} - H_{SET} - H_{TCA}\]

Where:

\begin{itemize}

      \item \(H_{GC}\) is the geophysically corrected photon height above the WGS84 ellipsoid
      \item \(H_{P}\) is the raw photon height above the WGS84 ellipsoid
      \item \(H_{OPT}\) is the height of the Ocean Pole tide
      \item \(H_{OL}\) is the height of the ocean load tide
      \item \(H_{SEPT}\) is the height of the solid earth pole \textbf{tide}
      \item \(H_{SET}\) is the solid earth tide
      \item \(H_{TCA}\) is the height of the total column atmospheric delay
\end{itemize}

The elevation value reported in ATL03 does not include the geoid or any tides. To find these values from the reported ellipsoidal height, the dataset includes correction factors for the tide-free geoid, the height difference between the tide-free and mean-tide geoid, and the height of the tide relative to the mean tide geoid as calculated by the GOT4.8 model. The mean sea level can be estimated by adding these correction factors to the ellipsoidal height. However, the GOT4.8 model tidal height is a based on a relatively low resolution grid, and therefore is less accurate in nearshore coastal areas and within embayments \parencite{Neumann2019e}. Therefore, it is proposed to use the data from the operational runs of the Global Tide and Surge Model, developed by Deltares, to convert the mean tide geoid elevation to the water depth at the date and time of the satellite pass.

\subsection{Signal Photon Identification}

The ATL03 data product includes a calculated confidence that a given photon return is signal or noise. The probability is assigned for each of the 5 surface types. Because bathymetric survey was not part of the original mission scope, there is no official classification for subsurface returns. Therefore within the default classification bathymetric photons are often classified as noise. However, the classification of ocean surface classification is reliable and can be used to filter out points at or above the sea surface.

To find bathymetric signal, a separate algorithm specifically calibrated to distinguish bathymetric signal from noise photons is applied to this data. There are several different techniques proposed in the literature. Some early research on small sites used manual classification \parencite{Forfinski-Sarkozi2016}. Other researchers have used implementations of DBSCAN \parencite{Ester1996}, with parameters that are set adaptively based on the local density of returns. Others

\todo{insert image}

\section{Satellite Derived bathymetry}
There are several established methods for calculating bathymetric data from passive optical and SAR satellite data, and recent advances in cloud computing capabilities like Google Earth Engine (GEE) \parencite{Gorelick2017a} make large catalogs of remote sensing data more accessible \parencite{Pike2019,Turner2021}. The major approaches can be classified into wave-kinematic and optical inversion techniques.

\subsection{Wave-Kinematic Bathymetry}
This approach uses the hydrodynamic properties of a wave field to estimate the bathymetry. The hydrodynamic variables like wave celerity and wave length are estimated from either optical or SAR satellite data. The bathymetry can then be calculated using the wave dispersion relation \cite{Almar2021e}. The major advantage of this method is that the results do not depend on the turbidity, which can be a significant limitation to optical SDB along many coastlines. The downsides to this approach are that the horizontal resolution is limited compared to optical methods, and the depth that it can reach is limited by the wavelength: longer waves feel the bottom earlier, so only in areas with significant swells can deeper bathymetry measurements be found \parencite{Almar2021e}.

\subsection{Optical Remote Sensing Bathymetry}
Optical remote sensing detects light from the sun reflected by the earth. Since the 1970s many methods of estimating bathymetry based on the optical quality of the water have been found, all based on the physical principle that water attenuates light. Optical methods require to the water to be \emph{optically shallow}, or clear enough that light can reach the sea floor. This is a significant restriction, but in places where it is applicable it gives very high resolution data of the seafloor. There are two broad types of algorithms for extracting bathymetric data from optical satellite imagery, analytical and empirical. Empirical models link the amount of attenuation of each pixel to in-situ depth measurements, and dervive a relatonship between color and depth. One advantage is that they are generally computationally inexpensive. Analytical or physics-based approaches require corrections for atmospheric and subsurface factors \parencite{Turner2021}.

Because of the ability to incorporate in-situ data and the computational ease, an empirical approach is envisioned for this project.

\subsection{Active-passive Sensor Fusion: The best of both worlds}
\citeauthor{Parrish2019} conclude that the best way to use ICESat-2 data for bathymetric survey is to combine it with optical/multispectral techniques. Because the lidar-derived data provides highly accurate point estimates along a linear track, and optical methods allow the estimation for a 2D area if field data is present, combining the two techniques provides a synergistic fusion of the strengths of both. The lidar-derived depths are used as training data for the multispectral models allowing a 2D picture of the bathymetry.

There have since been several studies that employ this approach, and evaluate different techniques for correcting refraction, finding bathymetric signal points, and combining the lidar data with optical techniques.

\subsection{Summary of prior research in fusion of optical and lidar SDB}

The studies that have used some version of the proposed technique are summarized in table \ref{tab:researchsummary}.

\newgeometry{bottom=20mm}
\begin{landscape}
      \begin{table}
            \caption{Summary of SDB research that combines spaceborne lidar and optical data}
            \label{tab:researchsummary}
            % \centering
            % \raggedright
            \begin{tabular}{p{3.7cm}llp{3.2cm}p{3.5cm}ll}
                  \midrule
                  Paper                              & Year & Dataset & Refraction Correction Method  & S/N Classification method      & Tide Correction & Notes                        \\
                  \hline
                  \citeauthor{Forfinski-Sarkozi2016} & 2016 & MABEL   & First-order depth correction  & Manual                         & N/A             & non-tidal                    \\
                  \citeauthor{Parrish2019}           & 2019 & ATL03   & Parrish method                & Manual                         & N/A             & used  ellipsoidal height     \\
                  \citeauthor{Ma2020}                & 2020 & ATL03   & Parrish + sloping sea surface & Adaptive DBSCAN                & OTPS2           & -                            \\
                  \citeauthor{Thomas2021d}           & 2020 & ATL03   & Parrish Method                & Manual                         & Not Specified   & -                            \\
                  \citeauthor{Albright2021}          & 2021 & ATL03   & First-order                   & Manual                         & N/A             & Converted to NAD83           \\
                  \citeauthor{Xie2021}               & 2021 & ATL03   & Parrish Method                & Adaptive DBSCAN                & Not specified   & DBSCAN is used iteratively   \\
                  \citeauthor{Cao2021}               & 2021 & ATL03   & First-order depth correction  & A-DRAGANN                      & OTPS2           & -                            \\
                  \citeauthor{Lee2021}               & 2021 & ATL03   & Not specified                 & Not specified                  & T\_TIDE         & -                            \\
                  \citeauthor{Liu2021}               & 2021 & ATL03   & Liu method                    & DBSCAN after Ma et al.         & TMD tidal model & -                            \\
                  \citeauthor{LeQuilleuc2022b}       & 2022 & ATL03   & Parrish                       & DBSCAN with manual corrrection & N/A             & Compared ellipsoidal heights \\
                  \bottomrule
            \end{tabular}
      \end{table}

\end{landscape}
\restoregeometry

\chapter{Practicalities}

\section{Planned Schedule}

Figure \ref{project-schedule} shows the tentative schedule for the project.
\todo{update schedule figure to reflect the methodology section}
\begin{landscape}

      \begin{figure}
            \centering
            \includegraphics[width=\paperwidth]{./figures/thesis-schedule.png}
            \caption{Tentative Schedule}
            \label{project-schedule}
      \end{figure}

\end{landscape}
\section{Planned final document outline}
